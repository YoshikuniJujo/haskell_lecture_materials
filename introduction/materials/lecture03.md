第3回 vimを学ぶ
===============

はじめに
--------

「Haskell講座」では聞いているだけでなく手を動かすことで
学習効果を高めるようにしている。
そのためにはエディタが使える必要がある。
指になじむエディタというものはプログラマの強力な武器となる。

今回はvimについて学ぶ。
しかし「エディタ戦争勃発」をふせぐためにnanoとEmacsも用意しておいた。
nanoやEmacsが指になじむという人はそれらを使っていただきたい。

演者がvim使いなので、ここでは、vimについて学ぶことにしよう。

vimの特徴
---------

カーソルの移動等の編集作業に普通のキーを使うということが大きな特徴である。
マウスは使わないので、いちいちキーボードから手を離す必要がない。
たとえば、カーソルの左上下右への移動にはそれぞれ'h', 'j', 'k', 'l'キーを使用する。

ここで、普通にアルファベットを入力したいときはどうすれば良いのか
という疑問が生じる。
答えはそれぞれの「モード」を用意するということだ。
ノーマルモードではカーソル移動等のコマンド入力を行い、
インサートモードでは直接文字を入力するようにすれば良い。

つまりvimは「モード付きのエディタ」であり、
vimを使用するときには常にモードを意識するということになる。

練習を始める前に
----------------

今回の講義では基本的な機能と、それ以外の便利な機能の一部を紹介する。
もちろん、今すべて覚える必要はない。
一度触れておくことで、
何かの際に「確か、こんな機能があったはず」と思い出せるだろう。

最後にもう一度触れるが、最低限必要なコマンドは以下の通りである。

* 'h', 'j', 'k', 'l'によるカーソル移動
* 'i', 'a'によるインサートモードへの遷移
* Escキーによるノーマルモードへの遷移
* 'x'による一文字削除
* ':wq'による保存終了

カーソル移動
------------

HHKBの練習のときに当ったファイルを開こう。

    vim practice.txt

カーソルは一番左下にある。
カーソルを左右に動かしてみよう。

* 左: h
* 右: l

何度か'l'を押してカーソルを右端まで持っていく。
次に、'h'を押してカーソルを左端まで持っていってみよう。

次は上下移動を試してみよう。

* 下: j
* 上: k

何度か'j'を押してカーソルを一番上まで持っていこう。
次に、'k'を押してカーソルを一番下まで持っていってみよう。

インサートモード
----------------

今学んだ'h', 'j', 'k', 'l'を使ってカーソルを好きな場所に移動させ、'i'を押す。
これで、インサートモードになった。

以下のように入力してみよう。

    Hello, world!

入力が終わったらインサートモードから抜ける。
Escキーを押せば良い。
EscキーはHHKBでは左手小指をめいっぱい左上にのばしたところにある。
これで'h', 'j', 'k', 'l'でカーソル移動ができるモードになる。
vimではこの状態が基本なので、このモードをノーマルモードと呼ぶ。

もとに戻す
----------

まちがった編集をしてしまってもとに戻したいときには'u'を押せば良い。

    undo: u

"Hello, world!"の'w'にカーソルを合わせてみよう。
そこで'i'を押し何かを入力する。
たとえば"miss"と入力してみよう。
Escキーでノーマルモードにもどってから'u'を押してみる。
もとに戻ったはずだ。

ちょっとしたまちがいならば、すぐにもとに戻すことができる。

インサートモード再び
--------------------

インサートモードへの移行にはいくつかの方法がある。
さっきと同じように'w'にカーソルを合わせてみよう。
ここで'i'を押し適当な文字を入力する。
たとえば"ABC"を入力する。
'w'の「前に」文字列が挿入される。
Escキーでノーマルモードに戻り、'u'でもとに戻す。

今度は'a'を押してから適当な文字を入力しよう。
たとえば"DEF"を入力する。
'w'の「後ろに」文字列が入力される。

* 'i': カーソルの前に文字列を挿入する
* 'a': カーソルの後ろに文字列を挿入する
